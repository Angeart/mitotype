<!DOCTYPE html>
<html lang="ja">
<!-- 
                                                                               ■      
  ■■         ■■■■■     ■■■■■      ■■           ■            ■                  ■      
  ■■   ■                  ■        ■   ■    ■■■■■■■    ■■■■■■■■■   ■■■■■■      ■ ■■■  
■■■■■■ ■       ■■        ■■  ■     ■ ■■■      ■             ■                ■■■■■ ■■ 
  ■  ■ ■■   ■■■■■■      ■■■  ■     ■■■       ■■■■ ■■      ■■■                  ■■  ■■ 
  ■  ■  ■      ■■     ■■■■■■■■     ■■       ■■  ■■■      ■  ■                 ■■   ■■ 
 ■■  ■  ■     ■■      ■ ■■  ■■■   ■■        ■  ■■■       ■  ■      ■         ■■■   ■  
 ■   ■       ■■■      ■ ■   ■■■   ■           ■ ■■        ■■■      ■         ■■■   ■  
■■   ■      ■■ ■■     ■■   ■■     ■■          ■            ■■      ■         ■ ■   ■ ■
■  ■■      ■■   ■■■■      ■■       ■■■■■■     ■■■■■■     ■■■        ■■■■■■     ■   ■■■
 -->

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/siimple@3.0.0/dist/siimple.min.css">
    <link rel="stylesheet" href="./css/modaal.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="hash" content="みとたいぴんぐ">
    <meta name="hash" content="月ノ美兎">
    <title>みとたいぴんぐ</title>
</head>
<style>
    html {
        font-size: calc(100vw / 100);
    }

    .trans,
    .trans * {
        transition-duration: 0.6s;
    }

    body {
        width: 100vw;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background-image: url(./img/mito01.jpg);
        background-blend-mode: screen;
        background-color: #888;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        overflow: hidden;
    }

    .input {
        margin: auto;
        opacity: 0;
    }

    .wait_screen {
        opacity: 0;
        position: absolute;
        width: 100vw;
        height: 100vh;
        z-index: -1;
        background-color: rgba(0, 0, 0, 0.3);
    }

    .state_2 .input,
    .state_3 .input {
        opacity: 1 !important;
    }

    .state_0 .start {
        opacity: 1;
        z-index: 100;
    }

    .state_1 .wait_screen {
        opacity: 1;
        z-index: 100;
    }

    .state_4 .result {
        opacity: 1;
        z-index: 100;
    }

    .input {
        z-index: -1;
        text-align: center;
    }

    .input>#main {
        width: 20vw;
        height: 4vh;
        left: 50%;
        position: relative;
        transform: translateX(-50%);
    }

    .timer>p {
        text-align: center;
        font-size: 4rem;
        margin-top: 0px;
        margin-bottom: 0.2rem;
        color: #ff91dc;
    }

    .score p {
        text-align: center;
        font-size: 2rem;
        margin-top: 0px;
    }

    .mondai>div {
        display: inline-block;
        left: 50%;
        position: relative;
        transform: translateX(-50%);
    }

    .mondai p {
        text-align: center;
        font-size: 2rem;
        display: inline-block;
        margin-top: 0px;
        margin-bottom: 0.2rem;
        white-space: pre;
    }

    .mondai p.wait::first-letter {
        color: rgb(200, 0, 120);
    }

    .mondai .done {
        color: #77d433;
    }

    p#kana {
        font-size: 3rem;
    }

    .mondai {
        display: flex;
    }

    .start {
        margin: 0;
        text-align: center;
        width: 100%;
        position: absolute;
        opacity: 0;
    }

    .start p.anim {
        font-size: 4rem;
        animation-name: start;
        animation-duration: 3s;
        animation-iteration-count: infinite;
    }

    @keyframes start {
        0% {
            font-size: 4rem;
        }
        50% {
            font-size: 3.9rem;
        }
        100% {
            font-size: 4rem;
        }
    }

    .count_down {
        margin: auto;
        display: inline-block;
        position: absolute;
        transform: translate(-50%, -50%);
        left: 50%;
        top: 50%;
    }

    .count_down p {
        color: #fff;
        font-size: 7rem;
        margin: 0px;
    }

    .result {
        opacity: 0;
        position: absolute;
        width: 100vw;
        height: 100vh;
    }

    .result>div {
        top: 50%;
        transform: translateY(-50%);
        position: relative;
    }

    .result .score_result>p {
        text-align: center;
        margin-top: 0px;
        font-size: 4rem;
    }

    .score_result p::before {
        content: 'score : ';
    }

    .trophy p::before {
        content: '称号 ';
    }

    .trophy p {
        text-align: center;
        font-size: 2rem;
    }

    .msg p {
        text-align: center;
        font-size: 1rem;
    }

    #title {
        font-size: 10rem;
        margin-bottom: -0.5rem;
    }

    .invisible {
        position: absolute;
        display: none;
    }

    #tweet {
        display: inline-block;
        left: 50%;
        position: relative;
        transform: translateX(-50%);
    }

    .tweet-share-custom {
        height: 32px;
        width: 32px;
        display: block;
        background-image: url(./img/twitter_icon.png);
        background-size: contain;
        background-repeat: no-repeat;
        margin: calc(32px * 0.25);
    }

    p.break {
        word-break: break-all;
        max-width: 100vw;
        white-space: normal;
        display: inline-block;
    }

    .small {
        font-size: 1.5rem;
    }

    span#erufu {
        background-image: url("./img/mori.png");
        width: 48px;
        height: 48px;
        display: inline-block;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
    }

    span.mori {
        background-image: url("./img/moyasuze.png");
        display: inline-block;
        width: 64px;
        height: 58px;
        background-size: contain;
        background-position-y: center;
        background-repeat-y: no-repeat;
        background-position-x: left;
    }

    span.mori.data {
        position: absolute;
        left: 0px;
        top: 0px;
    }

    span.mori.back {
        background-image: url("./img/moyasuze2.png");
        display: inline-block;
        z-index: 0;
        width: 215px;
    }


    div#rank {
        display: inline-block;
    }

    div#rank>div {
        position: relative;
    }

    div#uzai {
        background-image: url("./img/mito.png");
        display: inline-block;
        width: 200px;
        height: 200px;
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        position: absolute;
        top: 0px;
        left: 0px;
    }

    #option_modal {
        display: none;
    }

    .toggle-buttons {
        display: flex;
    }

    .toggle-buttons.vertical {
        flex-direction: column;
    }

    .toggle-buttons label {
        display: flex;
        position: relative;
    }

    .toggle-buttons [type=radio],
    .toggle-buttons [type=checkbox] {
        -webkit-appearance: none;
        -moz-appearance: none;
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
    }

    /* appearance: none; for IE11 */

    _:-ms-lang(x)::-ms-backdrop,
    .toggle-buttons [type=radio],
    _:-ms-lang(x)::-ms-backdrop,
    .toggle-buttons [type=checkbox] {
        visibility: hidden;
    }

    .toggle-buttons * {
        transition-duration: 0.5s;
        transition-property: opacity, color, background-color, border-color;
    }

    .toggle-buttons .button {
        z-index: 1;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .toggle-buttons.vertical .button {
        width: 100%;
    }

    .toggle-buttons:not(.vertical) :not(:first-child) .button {
        border-left: 0px;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .toggle-buttons:not(.vertical) :not(:last-child) .button {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        border-right: 0px;
    }

    .toggle-buttons.vertical :not(:first-child) .button {
        border-top: 0px;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
    }

    .toggle-buttons.vertical :not(:last-child) .button {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
    }

    .toggle-buttons :checked+.button {
        background-color: #345;
        border: solid 1px #345;
        color: #fff;
    }

    .toggle-buttons :disabled+.button {
        cursor: not-allowed;
        opacity: .6;
        color: #def;
    }

    .toggle-buttons input {
        outline: none;
        align-self: stretch;
    }

    .button {
        display: inline-block;
        padding: .5rem 1rem;
        border-radius: 4px;
        text-align: center;
        color: #abb;
        background-color: transparent;
        cursor: pointer;
        border: solid 1px #abb;
        min-width: 4rem;
    }

    .button:hover {
        background-color: #567;
        border: solid 1px #567;
        color: #fff
    }

    .button:disabled {
        cursor: not-allowed;
        opacity: .6;
        color: #def;
    }

    .flex_center {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .flex_right {
        display: flex;
        justify-content: flex-end;
        align-content: center;
    }

    .flex_between {
        display: flex;
        justify-content: space-between;
        align-content: center;
    }

    .flex_around {
        display: flex;
        justify-content: space-around;
        align-content: center;
        flex-wrap: wrap;
    }

    .flex_around>div {
        width: calc(100% / 4);
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 0.1rem;
    }

    .jisseki {
        display: inline-block;
    }

    .siimple-btn {
        font-size: 1rem;
        line-height: 2rem;
        height: 2rem;
    }

    .small_option {
        font-size: 0.5rem !important;
    }

    .size07 * {
        font-size: 0.7rem;
    }

    .timer>p::before {
        content: "🔥燃やすぜ🔥";
        font-weight: bold;
        font-size: 0rem;
        display: block;
        transition-duration: 1s;
    }

    body.fever .timer>p:before {
        animation: hurueru .1s infinite, fever 1s 1;
    }

    body.fever .mondai p {
        font-size: 12rem;
    }

    body.fever #kana {
        font-size: 0px;
    }

    @keyframes fever {
        0% {
            font-size: 0rem;
        }
        50% {
            font-size: 10rem;
        }
        100% {
            font-size: 0rem;
        }
    }

    @keyframes hurueru {
        0% {
            transform: translate(0px, 0px) rotateZ(0deg)
        }
        25% {
            transform: translate(2px, 2px) rotateZ(1deg)
        }
        50% {
            transform: translate(0px, 2px) rotateZ(0deg)
        }
        75% {
            transform: translate(2px, 0px) rotateZ(-1deg)
        }
        100% {
            transform: translate(0px, 0px) rotateZ(0deg)
        }
    }

    .input-range[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        background-color: #eaeaea;
        height: 2px;
        width: 100%;
        border-radius: 6px;

    }

    .input-range[type="range"]:focus,
    .input-range[type="range"]:active {
        outline: none;
    }

    .input-range[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        cursor: pointer;
        position: relative;
        width: 22px;
        height: 22px;
        display: block;
        background-color: #345;
        border-radius: 50%;
        -webkit-border-radius: 50%;
    }

    .top1rem {
        margin-top: 1rem;
    }
</style>

<body class="state_0" oncontextmenu="return false;">
    <div id="option_modal">
        <div class="flex_around size07" id="optiondatas">
            <div class="indata">し</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="si_or_shi" checked>
                        <span class="button">shi</span>
                    </label>
                    <label>
                        <input type="radio" name="si_or_shi">
                        <span class="button">si</span>
                    </label>
                </div>
            </div>
            <div class="indata">じ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zi_or_ji" checked>
                        <span class="button">zi</span>
                    </label>
                    <label>
                        <input type="radio" name="zi_or_ji">
                        <span class="button">ji</span>
                    </label>
                </div>
            </div>
            <div class="indata">ち</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="ti_or_chi" checked>
                        <span class="button">ti</span>
                    </label>
                    <label>
                        <input type="radio" name="ti_or_chi">
                        <span class="button">chi</span>
                    </label>
                </div>
            </div>
            <div class="indata">しゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="sya_or_sha" checked>
                        <span class="button">sya</span>
                    </label>
                    <label>
                        <input type="radio" name="sya_or_sha">
                        <span class="button">sha</span>
                    </label>
                </div>
            </div>
            <div class="indata">つ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tu_or_tsu" checked>
                        <span class="button">tu</span>
                    </label>
                    <label>
                        <input type="radio" name="tu_or_tsu">
                        <span class="button">tsu</span>
                    </label>
                </div>
            </div>
            <div class="indata">しゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="syu_or_shu" checked>
                        <span class="button">syu</span>
                    </label>
                    <label>
                        <input type="radio" name="syu_or_shu">
                        <span class="button">shu</span>
                    </label>
                </div>
            </div>
            <div class="indata">ふ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="fu_or_hu" checked>
                        <span class="button">fu</span>
                    </label>
                    <label>
                        <input type="radio" name="fu_or_hu">
                        <span class="button">hu</span>
                    </label>
                </div>
            </div>
            <div class="indata">しぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="sye_or_she" checked>
                        <span class="button">sye</span>
                    </label>
                    <label>
                        <input type="radio" name="sye_or_she">
                        <span class="button">she</span>
                    </label>
                </div>
            </div>
            <div class="indata">ん</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="n_or_nn" checked>
                        <span class="button">n</span>
                    </label>
                    <label>
                        <input type="radio" name="n_or_nn">
                        <span class="button">nn</span>
                    </label>
                </div>
            </div>
            <div class="indata">しょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="syo_or_sho" checked>
                        <span class="button">syo</span>
                    </label>
                    <label>
                        <input type="radio" name="syo_or_sho">
                        <span class="button">sho</span>
                    </label>
                </div>
            </div>
            <div class="indata">ぁ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xa_or_la" checked>
                        <span class="button">xa</span>
                    </label>
                    <label>
                        <input type="radio" name="xa_or_la">
                        <span class="button">la</span>
                    </label>
                </div>
            </div>
            <div class="indata">じゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zya_or_jya_ja" checked>
                        <span class="button">zya</span>
                    </label>
                    <label>
                        <input type="radio" name="zya_or_jya_ja">
                        <span class="button">jya</span>
                    </label>
                    <label>
                        <input type="radio" name="zya_or_jya_ja">
                        <span class="button">ja</span>
                    </label>
                </div>
            </div>
            <div class="indata">ぃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xi_or_li" checked>
                        <span class="button">xi</span>
                    </label>
                    <label>
                        <input type="radio" name="xi_or_li">
                        <span class="button">li</span>
                    </label>
                </div>
            </div>
            <div class="indata">じぃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zyi_or_jyi_or_jili" checked>
                        <span class="button">zyi</span>
                    </label>
                    <label>
                        <input type="radio" name="zyi_or_jyi_or_jili">
                        <span class="button">jyi</span>
                    </label>
                    <label>
                        <input type="radio" name="zyi_or_jyi_or_jili">
                        <span class="button">jili</span>
                    </label>
                </div>
            </div>
            <div class="indata">ぅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xu_or_lu" checked>
                        <span class="button">xu</span>
                    </label>
                    <label>
                        <input type="radio" name="xu_or_lu">
                        <span class="button">lu</span>
                    </label>
                </div>
            </div>
            <div class="indata">じゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zyu_or_jyu_or_ju" checked>
                        <span class="button">zyu</span>
                    </label>
                    <label>
                        <input type="radio" name="zyu_or_jyu_or_ju">
                        <span class="button">jyu</span>
                    </label>
                    <label>
                        <input type="radio" name="zyu_or_jyu_or_ju">
                        <span class="button">ju</span>
                    </label>
                </div>
            </div>
            <div class="indata">ぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xe_or_le" checked>
                        <span class="button">xe</span>
                    </label>
                    <label>
                        <input type="radio" name="xe_or_le">
                        <span class="button">le</span>
                    </label>
                </div>
            </div>
            <div class="indata">じぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zye_or_jye_or_je" checked>
                        <span class="button">zye</span>
                    </label>
                    <label>
                        <input type="radio" name="zye_or_jye_or_je">
                        <span class="button">jye</span>
                    </label>
                    <label>
                        <input type="radio" name="zye_or_jye_or_je">
                        <span class="button">je</span>
                    </label>
                </div>
            </div>
            <div class="indata">ぉ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xo_or_lo" checked>
                        <span class="button">xo</span>
                    </label>
                    <label>
                        <input type="radio" name="xo_or_lo">
                        <span class="button">lo</span>
                    </label>
                </div>
            </div>
            <div class="indata">じょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="zyo_or_jyo_or_jo" checked>
                        <span class="button">zyo</span>
                    </label>
                    <label>
                        <input type="radio" name="zyo_or_jyo_or_jo">
                        <span class="button">jyo</span>
                    </label>
                    <label>
                        <input type="radio" name="zyo_or_jyo_or_jo">
                        <span class="button">jo</span>
                    </label>
                </div>
            </div>
            <div class="indata">っ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xtu_or_ltu_or_x" checked>
                        <span class="button">xtu</span>
                    </label>
                    <label>
                        <input type="radio" name="xtu_or_ltu_or_x">
                        <span class="button">ltu</span>
                    </label>
                </div>
            </div>
            <div class="indata">ちゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tya_or_cya_or_cha" checked>
                        <span class="button">tya</span>
                    </label>
                    <label>
                        <input type="radio" name="tya_or_cya_or_cha">
                        <span class="button">cya</span>
                    </label>
                    <label>
                        <input type="radio" name="tya_or_cya_or_cha">
                        <span class="button">cha</span>
                    </label>
                </div>
            </div>
            <div class="indata">ゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xya_or_lya" checked>
                        <span class="button">xya</span>
                    </label>
                    <label>
                        <input type="radio" name="xya_or_lya">
                        <span class="button">lya</span>
                    </label>
                </div>
            </div>
            <div class="indata">ちぃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tyi_or_cyi" checked>
                        <span class="button">tyi</span>
                    </label>
                    <label>
                        <input type="radio" name="tyi_or_cyi">
                        <span class="button">cyi</span>
                    </label>
                </div>
            </div>
            <div class="indata">ゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xyu_or_lyu" checked>
                        <span class="button">xyu</span>
                    </label>
                    <label>
                        <input type="radio" name="xyu_or_lyu">
                        <span class="button">lyu</span>
                    </label>
                </div>
            </div>
            <div class="indata">ちゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tyu_or_cyu_or_chu" checked>
                        <span class="button">tyu</span>
                    </label>
                    <label>
                        <input type="radio" name="tyu_or_cyu_or_chu">
                        <span class="button">cyu</span>
                    </label>
                    <label>
                        <input type="radio" name="tyu_or_cyu_or_chu">
                        <span class="button">chu</span>
                    </label>
                </div>
            </div>
            <div class="indata">ょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xyo_or_lyo" checked>
                        <span class="button">xyo</span>
                    </label>
                    <label>
                        <input type="radio" name="xyo_or_lyo">
                        <span class="button">lyo</span>
                    </label>
                </div>
            </div>
            <div class="indata">ちぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tye_or_cye_or_che" checked>
                        <span class="button">tye</span>
                    </label>
                    <label>
                        <input type="radio" name="tye_or_cye_or_che">
                        <span class="button">cye</span>
                    </label>
                    <label>
                        <input type="radio" name="tye_or_cye_or_che">
                        <span class="button">che</span>
                    </label>
                </div>
            </div>
            <div class="indata">ゎ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="xwa_or_lwa" checked>
                        <span class="button">xwa</span>
                    </label>
                    <label>
                        <input type="radio" name="xwa_or_lwa">
                        <span class="button">lwa</span>
                    </label>
                </div>
            </div>
            <div class="indata">ちょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="tyo_or_cyo_or_cho" checked>
                        <span class="button">tyo</span>
                    </label>
                    <label>
                        <input type="radio" name="tyo_or_cyo_or_cho">
                        <span class="button">cyo</span>
                    </label>
                    <label>
                        <input type="radio" name="tyo_or_cyo_or_cho">
                        <span class="button">cho</span>
                    </label>
                </div>
            </div>
            <div class="indata">てゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_tha" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_tha">
                        <span class="button">tha</span>
                    </label>
                </div>
            </div>
            <div class="indata">でゃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_dha" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_dha">
                        <span class="button">dha</span>
                    </label>
                </div>
            </div>
            <div class="indata">てぃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_thi" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_thi">
                        <span class="button">thi</span>
                    </label>
                </div>
            </div>
            <div class="indata">でぃ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_dhi" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_dhi">
                        <span class="button">dhi</span>
                    </label>
                </div>
            </div>
            <div class="indata">てゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_thu" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_thu">
                        <span class="button">thu</span>
                    </label>
                </div>
            </div>
            <div class="indata">でゅ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_dhu" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_dhu">
                        <span class="button">dhu</span>
                    </label>
                </div>
            </div>
            <div class="indata">てぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_the" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_the">
                        <span class="button">the</span>
                    </label>
                </div>
            </div>
            <div class="indata">でぇ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_dhe" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_dhe">
                        <span class="button">dhe</span>
                    </label>
                </div>
            </div>
            <div class="indata">てょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_tho" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_tho">
                        <span class="button">tho</span>
                    </label>
                </div>
            </div>
            <div class="indata">でょ</div>
            <div>
                <div class="toggle-buttons">
                    <label>
                        <input type="radio" name="none_or_dho" checked>
                        <span class="button">-</span>
                    </label>
                    <label>
                        <input type="radio" name="none_or_dho">
                        <span class="button">dho</span>
                    </label>
                </div>
            </div>
            <div class="top1rem">音量</div>
            <div class="top1rem">
                <input id="volume" class="input-range" type="range" value="100">
            </div>
            <div class="top1rem">
                <span id="volume_val">100</span>
            </div>
        </div>
    </div>
    <div class="start trans">
        <p id="title">みとたいぴんぐ</p>
        <p class="small">chrome 推奨！！</p>
        <p class="anim trans">Enter で start</p>
        <div href="#option_modal" id="open_option" class="siimple-btn siimple-btn--navy">オプション</div>
    </div>
    <div class="wait_screen trans">
        <div class="count_down">
            <p></p>
        </div>
    </div>
    <div class="result trans">
        <div>
            <div class="score_result">
                <p>999999</p>
            </div>
            <div class="trophy">
                <p>クソザコムカデ</p>
            </div>
            <div class="msg">
                <p>Enter で 最初に戻る</p>
                <div id="tweet">
                    <a href="http://twitter.com/share" data-text="" class="tweet-share-custom"></a>
                </div>
                <p>
                    <a href="https://twitter.com/shinomiya_ag">@shinomiya_ag</a>
                </p>
            </div>
        </div>
    </div>
    <div class="input trans">
        <div class="timer">
            <p>99</p>
        </div>
        <div class="score">
            <p>0</p>
        </div>
        <div class="jisseki">
            <span id="erufu"></span>
            <div id="rank">
                <div>
                    <span class="mori back"></span>
                    <span class="mori data"></span>
                </div>
            </div>
        </div>
        <div class="kana">
            <p id="kana"></p>
        </div>
        <div class="mondai">
            <div>
                <p class="done"></p>
                <p class="wait">monndai</p>
            </div>
        </div>
        <div id="uzai" class="trans"></div>
        <input type="button" class="invisible">
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.4/TweenMax.min.js" crossorigin="anonymous"></script>
    <script>
        $('.invisible').trigger("click");
    </script>
    <script src="./js/ion.sound.js"></script>
    <script src="./js/modaal.min.js"></script>
    <script src="./js/mt.js"></script>
    <script>
        function load() {
            let json_data = window.localStorage.getItem('option');
            if (json_data == null) return;
            let data = JSON.parse(json_data);

            for (var item of data) {
                var index = 0;
                for (var form of $('#optiondatas input[name=' + item.name + ']')) {
                    if ($(form).next().text() == item.sel) break;
                    index++;
                }
                $('#optiondatas input[name=' + item.name + ']:eq(' + index + ')').prop('checked', true);
            }
        }
        load();
        function get_replace_map() {
            let replace_map = [];
            for (var item of $('#optiondatas input:checked')) {
                replace_str = $(item).next().text();
                if (replace_str === undefined || replace_str == "-") continue;
                let in_str = $(item).closest('.toggle-buttons').parent().prev().text();
                replace_map.push({ in: in_str, regex: new RegExp(in_str, 'g'), out: replace_str });
            }
            let std_map = [
                { in: "あ", regex: /あ/g, out: "a" },
                { in: "い", regex: /い/g, out: "i" },
                { in: "う", regex: /う/g, out: "u" },
                { in: "え", regex: /え/g, out: "e" },
                { in: "お", regex: /お/g, out: "o" },
                { in: "か", regex: /か/g, out: "ka" },
                { in: "き", regex: /き/g, out: "ki" },
                { in: "く", regex: /く/g, out: "ku" },
                { in: "け", regex: /け/g, out: "ke" },
                { in: "こ", regex: /こ/g, out: "ko" },
                { in: "さ", regex: /さ/g, out: "sa" },
                { in: "す", regex: /す/g, out: "su" },
                { in: "せ", regex: /せ/g, out: "se" },
                { in: "そ", regex: /そ/g, out: "so" },
                { in: "た", regex: /た/g, out: "ta" },
                { in: "て", regex: /て/g, out: "te" },
                { in: "と", regex: /と/g, out: "to" },
                { in: "な", regex: /な/g, out: "na" },
                { in: "に", regex: /に/g, out: "ni" },
                { in: "ぬ", regex: /ぬ/g, out: "nu" },
                { in: "ね", regex: /ね/g, out: "ne" },
                { in: "の", regex: /の/g, out: "no" },
                { in: "は", regex: /は/g, out: "ha" },
                { in: "ひ", regex: /ひ/g, out: "hi" },
                { in: "へ", regex: /へ/g, out: "he" },
                { in: "ほ", regex: /ほ/g, out: "ho" },
                { in: "ま", regex: /ま/g, out: "ma" },
                { in: "み", regex: /み/g, out: "mi" },
                { in: "む", regex: /む/g, out: "mu" },
                { in: "め", regex: /め/g, out: "me" },
                { in: "も", regex: /も/g, out: "mo" },
                { in: "や", regex: /や/g, out: "ya" },
                { in: "ゆ", regex: /ゆ/g, out: "yu" },
                { in: "よ", regex: /よ/g, out: "yo" },
                { in: "ら", regex: /ら/g, out: "ra" },
                { in: "り", regex: /り/g, out: "ri" },
                { in: "る", regex: /る/g, out: "ru" },
                { in: "れ", regex: /れ/g, out: "re" },
                { in: "ろ", regex: /ろ/g, out: "ro" },
                { in: "わ", regex: /わ/g, out: "wa" },
                { in: "を", regex: /を/g, out: "wo" },
                { in: "が", regex: /が/g, out: "ga" },
                { in: "ぎ", regex: /ぎ/g, out: "gi" },
                { in: "ぐ", regex: /ぐ/g, out: "gu" },
                { in: "げ", regex: /げ/g, out: "ge" },
                { in: "ご", regex: /ご/g, out: "go" },
                { in: "ざ", regex: /ざ/g, out: "za" },
                { in: "ず", regex: /ず/g, out: "zu" },
                { in: "ぜ", regex: /ぜ/g, out: "ze" },
                { in: "ぞ", regex: /ぞ/g, out: "zo" },
                { in: "だ", regex: /だ/g, out: "da" },
                { in: "ぢ", regex: /ぢ/g, out: "di" },
                { in: "づ", regex: /づ/g, out: "du" },
                { in: "で", regex: /で/g, out: "de" },
                { in: "ど", regex: /ど/g, out: "do" },
                { in: "ば", regex: /ば/g, out: "ba" },
                { in: "び", regex: /び/g, out: "bi" },
                { in: "ぶ", regex: /ぶ/g, out: "bu" },
                { in: "べ", regex: /べ/g, out: "be" },
                { in: "ぼ", regex: /ぼ/g, out: "bo" },
                { in: "ぱ", regex: /ぱ/g, out: "pa" },
                { in: "ぴ", regex: /ぴ/g, out: "pi" },
                { in: "ぷ", regex: /ぷ/g, out: "pu" },
                { in: "ぺ", regex: /ぺ/g, out: "pe" },
                { in: "ぽ", regex: /ぽ/g, out: "po" },
                { in: "ー", regex: /ー/g, out: "-" },
                { in: "にゃ", regex: /にゃ/g, out: "nya" },
                { in: "にゅ", regex: /にゅ/g, out: "nyu" },
                { in: "にょ", regex: /にょ/g, out: "nyo" },
                { in: "うぃ", regex: /うぃ/g, out: "wi" },
                { in: "うぇ", regex: /うぇ/g, out: "we" },
                { in: "ひゃ", regex: /ひゃ/g, out: "hya" },
                { in: "ひゅ", regex: /ひゅ/g, out: "hyu" },
                { in: "ひょ", regex: /ひょ/g, out: "hyo" },
                { in: "ふぁ", regex: /ふぁ/g, out: "fa" },
                { in: "ふぃ", regex: /ふぃ/g, out: "fi" },
                { in: "ふぇ", regex: /ふぇ/g, out: "fe" },
                { in: "ふぉ", regex: /ふぉ/g, out: "fo" },
                { in: "みゃ", regex: /みゃ/g, out: "mya" },
                { in: "みゅ", regex: /みゅ/g, out: "myu" },
                { in: "みょ", regex: /みょ/g, out: "myo" },
                { in: "りゃ", regex: /りゃ/g, out: "rya" },
                { in: "りゅ", regex: /りゅ/g, out: "ryu" },
                { in: "りょ", regex: /りょ/g, out: "ryo" },
                { in: "きゃ", regex: /きゃ/g, out: "kya" },
                { in: "きゅ", regex: /きゅ/g, out: "kyu" },
                { in: "きょ", regex: /きょ/g, out: "kyo" },
                { in: "くぁ", regex: /くぁ/g, out: "qa" },
                { in: "くぃ", regex: /くぃ/g, out: "qi" },
                { in: "くぇ", regex: /くぇ/g, out: "qe" },
                { in: "くぉ", regex: /くぉ/g, out: "qo" },
            ];
            replace_map = replace_map.concat(std_map);
            replace_map.sort((a, b) => {
                if (a.in.length > b.in.length) return -1;
                if (a.in.length < b.in.length) return 1;
                return 0;
            });
            return replace_map;
        }
        let mt = new MersenneTwister();

        function kana2roma(str, map) {
            str = str.replace(/っ([^なにぬねの])/g, "_$1");
            for (var data of map) {
                str = str.replace(data.regex, data.out);
            }
            str = str.replace(/_(.)/g, "$1$1");
            return str;
        } $('#open_option').modaal({
            before_close: () => {
                if (!window.localStorage) return;
                let data = [];
                for (var val of $('#optiondatas input:checked')) {
                    data.push({ name: $(val).attr('name'), sel: $(val).next().text() });
                }
                let json_data = JSON.stringify(data);
                window.localStorage.setItem('option', json_data);
            }
        });
        let text_data = [
            { name: "3分とは言わず今死ね", data: "3ふんとはいわずにいましね", origin: "3分とは言わずに今死ね" },
            { name: "BAN", data: "ban", noregex: true, origin: "BAN" },
            { name: "BBS", data: "bbs", noregex: true, origin: "BBS" },
            { name: "linenews", data: "line news", noregex: true, origin: "line news" },
            { name: "men is forest women is river", data: "men is forest woman is river", noregex: true, origin: "men is forest women is river" },
            { name: "oldold", data: "old old", noregex: true, origin: "old old" },
            { name: "thatplace", data: "that place", noregex: true, origin: "that place" },
            { name: "X8", data: "xxxxxxxx", noregex: true, origin: "X8回" },
            { name: "あっふーん", data: "あっふーん", origin: "あっふーん" },
            { name: "アナログ炬燵2", data: "あなろぐごたつ", origin: "アナログ炬燵" },
            { name: "あらまぁ", data: "あらまぁ", origin: "あらまぁ" },
            { name: "えやってないですよあたくし", data: "えやってないですよあたくし", origin: "えやってないですよあたくし" },
            { name: "おっなんだ？ファックだと？", data: "おっなんだ？ふぁっくだと", origin: "おっなんだ？ファックだと？" },
            { name: "おるやんけおるやんけどなたかおるやんけ", data: "おるやんけおるやんけどなたかおるやんけ", origin: "おるやんけ おるやんけ どなたかおるやんけ" },
            { name: "クソゲー乙", data: "くそげーおつ", origin: "クソゲー乙" },
            { name: "クソザコイングリッシュ", data: "くそざこいんぐりっしゅ", origin: "クソザコイングリッシュ" },
            { name: "クソザコパンチやめてください", data: "くそざこぱんちやめてください", origin: "クソザコパンチやめてください" },
            { name: "グルシャン", data: "ぐるしゃん", origin: "グルシャン" },
            { name: "クローバー", data: "くろーばー", origin: "クローバー" },
            { name: "コココココン", data: "ここここここん", origin: "コココココン" },
            { name: "これがVirtualYoutuberなんだよなぁ", data: "これがvirtualyoutuberなんだよなぁ", origin: "これがVirtualYoutuberなんだよなぁ" },
            { name: "スッペラピッチョン2", data: "すっぺらぴっちょん", origin: "スッペラピッチョン" },
            { name: "っく", data: "っく", origin: "っく" },
            { name: "トレーディングカードゲーム", data: "とれーでぃんぐかーどげーむ", origin: "トレーディングカードゲーム" },
            { name: "ネズミの死骸", data: "ねずみのしがい", origin: "ネズミの死骸" },
            { name: "パンツマンさん", data: "ぱんつまんさん", origin: "パンツマンさん" },
            { name: "ふざけんなおまえ", data: "ふざけんなおまえ", origin: "ふざけんなおまえ" },
            { name: "ヘテロヘテロ", data: "へてろへてろ", origin: "ヘテロヘテロ" },
            { name: "ムカデ人間2", data: "むかでにんげん", origin: "ムカデ人間" },
            { name: "もみじ", data: "もみじ", origin: "もみじ" },
            { name: "わたくし2", data: "わたくし", origin: "わたくし" },
            { name: "わたくしで隠さなきゃ", data: "わたくしでかくさなきゃ", origin: "わたくしで隠さなきゃ" },
            { name: "覚せい剤を追放しよう", data: "かくせいざいをついほうしよう", origin: "覚せい剤を追放しよう" },
            { name: "許さねぇからなお前", data: "ゆるさねぇからなおまえ", origin: "許さねぇからなお前" },
            { name: "緊急事態", data: "きんきゅうじたい", origin: "緊急事態" },
            { name: "愚の直行", data: "ぐのちょっこう", origin: "愚の直行" },
            { name: "警察舐めとんちゃうぞこら", data: "けいさつなめとんちゃうぞこら", origin: "警察舐めとんちゃうぞこら" },
            { name: "血吐き少女", data: "ちはきしょうじょ", origin: "血吐き少女" },
            { name: "校庭に生えてる草のコンプ", data: "こうていにはえてるくさのこんぷ", origin: "校庭に生えてる草のコンプ" },
            { name: "砂糖卵小麦粉", data: "さとうたまごこむぎこ", origin: "砂糖 卵 小麦粉" },
            { name: "雑草", data: "ざっそう", origin: "雑草" },
            { name: "んんえ゛っえへへん", data: "んえっえへへん", origin: "んえっえへへん" },
            { name: "三角関係", data: "さんかくかんけい", origin: "三角関係" },
            { name: "死んだ胎児", data: "しんだたいじ", origin: "死んだ胎児" },
            { name: "実質会食", data: "じっしつかいしょく", origin: "実質会食" },
            { name: "酒井ぃ？名前覚えたからなぁ", data: "さかいぃ?なまえおぼえたからなぁ", origin: "酒井ぃ？名前覚えたからなぁ" },
            { name: "親友が教室でウンコ漏らしたら自分もウンコ漏らすべきなんですよ", data: "しんゆうがきょうしつでうんこもらしたらじぶんもうんこもらすべきなんですよ", origin: "親友が教室でウンコ漏らしたら自分もウンコ漏らすべきなんですよ" },
            { name: "川の中の石を割る", data: "かわのなかのいしをわる", origin: "川の中の石を割る" },
            { name: "洗濯機2", data: "せんたっき", origin: "洗濯機" },
            { name: "中腰", data: "ちゅうごし", origin: "中腰" },
            { name: "頭脳明晰容姿端麗ポケモンマスター", data: "ずのうめいせきようしたんれいぽけもんますたー", origin: "頭脳明晰容姿端麗ポケモンマスター" },
            { name: "彼とチューしたいって思っちゃんたんですよねわたくし", data: "かれとちゅーしたいっておもっちゃったんですよねわたくし", origin: "彼とチューしたいって思っちゃんたんですよねわたくし" },
            //{ name: "ルイズコピペ", data: "ruizu ruizu ruizu ruizu he uwaaaaaaaaaa ltu guwaa aaaaaa ruizu ruizu ruizu ruizu nuwaaahhahhahaaaa ala kunka kunka kunka kunka su-ha-su-ha- su-ha-su-ha- iinioi danala kunkun nnleahhaa ruizu furansowa tan no momoiro burondo no kami wo kunka kunka shitaiyo kunka kunka alaltu... a e tyotto matte machigaeta! mohumohu shitaiyo mohumohu mohumohu kamikamimohumohu karikarimohumohu kyunkyunkyun shousetsu 12kan no ruizu tan kawaikatta yo ala a ala uwaaaa manime 2ki housou sarete yokattayo ruizu tan alaltsu kawaii ruizu tan kawaii altu alaa komikku 2kan mo hatsubai sarete ureshiiii iyaaaaa nyaaan kyaaaaa kuwaaaaaa komikku nante genjitu janai altu shousetsu mo anime moyoku kangaetara ruizu chan ha genjitsu janai nyaaaaann nnwaaaaaaaa ahahaha sonnaaa iyaa aaha ha sonnaa harugenyaaa konna chikushoume yameteyaru genjitsu nante yame... mite...ru? hyoushie no ruizu chan ga bokuwo miteru... hyoushie no ruizu chan ga boku wo miteruzo! ruizu chan ga boku wo miteruzo sashie no ruizu chan ga boku wo miteru zo anime no ruizu chan ga bokuni hanashikaketeruzo yokattala yononaka madamada sutema sutetamonjanaine iyahhooooo! boku niha ruizu chan ga iru yattayo kethi hitori de dekiru mon! altu komikku noruizu chan iyaaaahahahaaaan ansama shi shiesuta anrietta tabasa uultu nnnn oreno omoiyo ruizu ni todoke harugenia no ruizu he todoke"},
        ];
        let ikirito_data = {
            name: "イキリト", data: "おれすがいけぼだからさwいちおうおたくだけどかのじょいるしwおれってひけないせいかくだしwそこらへんとかめっちゃにてるっていわれるwあくりょくも31きろあってwくらすのじょしにたかられるwかのじょいるからやめろwおれこれでもちゅういちですよw?かのじょはあすなにですw(きいてねぇ)",
            origin: "俺素がイケボだからさｗ一応オタクだけど彼女いるしｗ俺ってひけない性格だしｗそこらへんとかめっちゃ似てるって言われるｗ握力も31kgあってｗクラスの女子にたかられるｗ彼女いるからやめろｗ俺これでも中1ですよｗ？彼女はアスナ似ですｗ（聞いてねぇ）"
        };
        let base_sounds = [
            { name: "snap" },
            { name: "door_bell" },
            { name: "correct2" },
            { name: "incorrect1" },
            { name: "people_people-stadium-applause1" },
            { name: "don" },
            { name: "katana-gesture1" },
        ];
        let sound_data = base_sounds.concat(text_data.map((v) => { return { name: v.name }; })).concat([{ name: ikirito_data.name }]);
        $.ionSound({
            sounds: sound_data,
            path: "sounds/",
            preload: true,
            multiplay: true,
            volume: 0.9
        });
        let volume = 1;

        $('#volume').on('input', function () {
            $('#volume_val').text($(this).val());
        });

        $('#volume').on('change', function () {
            volume = $(this).val() / 100;
            $.ionSound.play("んんえ゛っえへへん", { volume: volume });
        });

        var perlin = (() => {
            function noise(x) {
                x = (x << 13) ^ x;
                return (1 - ((x * (x * x * 15731 + 789221) + 1376312589) & 0x7fffffff) / 1073741824);
            }

            function smooth_noise(x) {
                return noise(x) * 0.5 + noise(x - 1) * 0.25 + noise(x + 1) * 0.25;
            }

            function cos_interpolate(a, b, x) {
                let ft = x * Math.PI;
                let f = (1 - Math.cos(ft)) * 0.5;
                return a * (1 - f) + b * f;
            }

            function interpolated_noise(x) {
                let int_x = Math.floor(x);
                let fractional_x = x - int_x;
                let v1 = smooth_noise(int_x);
                let v2 = smooth_noise(int_x + 1);
                return cos_interpolate(v1, v2, fractional_x);
            }

            function perlin(x) {
                let total = 0;
                let p = 1 / 4;
                for (var i = 0; i < 6; ++i) {
                    let freq = Math.pow(2, i);
                    let amp = Math.pow(p, i);
                    total += interpolated_noise(x * freq) * amp;
                }
                return total;
            }
            return perlin;
        })();

        var MutekiTimer = (function () {
            var MutekiTimer = function () {
                initialize.apply(this, arguments);
            }, $this = MutekiTimer.prototype;

            var TIMER_PATH = (function () {
                var BlobBuilder, URL, builder;
                BlobBuilder = self.WebKitBlobBuilder || self.MozBlobBuilder;
                URL = self.URL || self.webkitURL;
                if (BlobBuilder && URL) {
                    builder = new BlobBuilder();
                    builder.append("var timerId = 0;");
                    builder.append("this.onmessage = function(e) {");
                    builder.append("  if (timerId !== 0) {");
                    builder.append("    clearInterval(timerId);");
                    builder.append("    timerId = 0;");
                    builder.append("  }");
                    builder.append("  if (e.data > 0) {");
                    builder.append("    timerId = setInterval(function() {");
                    builder.append("        postMessage(null);");
                    builder.append("    }, e.data);");
                    builder.append("  }");
                    builder.append("};");
                    return URL.createObjectURL(builder.getBlob());
                }
                return null;
            }());

            var initialize = function () {
                if (TIMER_PATH) {
                    this._timer = new Worker(TIMER_PATH);
                    this.isMuteki = true;
                } else {
                    this._timer = null;
                    this.isMuteki = false;
                }

                this._timerId = 0;
            };

            $this.setInterval = function (func, interval) {
                if (this._timer !== null) {
                    this._timer.onmessage = func;
                    this._timer.postMessage(interval);
                } else {
                    if (this._timerId !== 0) {
                        clearInterval(this._timerId);
                    }
                    this._timerId = setInterval(func, interval);
                }
            };

            $this.clearInterval = function () {
                if (this._timer !== null) {
                    this._timer.postMessage(0);
                } else if (this._timerId !== 0) {
                    clearInterval(this._timerId);
                    this._timerId = 0;
                }
            };

            return MutekiTimer;
        }());

        function shuffle(array) {
            var n = array.length, t, i;

            while (n) {
                i = Math.floor(Math.random() * n--);
                t = array[n];
                array[n] = array[i];
                array[i] = t;
            }

            return array;
        }
        const pixel_per_em = Number(getComputedStyle(document.body, null).fontSize.replace(/[^\d]/g, ''));

        function char_count(str) {
            let len = 0;
            str = escape(str);
            for (let i = 0; i < str.length; i++ , len++) {
                if (str.charAt(i) == "%") {
                    if (str.charAt(++i) == "u") {
                        i += 3;
                        len++;
                    }
                    i++;
                }
            }
            return len;
        }

        function str_pixel(str) {
            return char_count(str) * pixel_per_em
        }


        let state = 0;

        (() => {
            let remain_default = 99;
            let remain = remain_default;
            let trophies = [
                , '3分と言わず今死ね'
                , 'クソザコナメクジ'
                , 'サブカルクソムカデ'
                , '血糊クッキー'
                , 'もみじ'
                , 'クソザコパンチ'
                , '七草'
                , 'ゴリラ'
                , '洗濯機'
                , 'カブトガニ'
                , '血吐き少女'
                , 'ムカデ人間'
                , '赤子の拳'
                , 'みょうが'
                , '中腰委員長'
                , '納豆'
                , 'ヘテロヘテロ'
                , 'クローバー'
                , 'もやすぜ'
                , '清楚(Vtuber)'
                , '雑草コンプ'
                , '清純系委員長'
                , '頭脳明晰容姿端麗ポケモンマスター'
                , 'これがバーチャルYouTuberなんだよなぁ…'
                , 'かえみとを末永くよろしくお願いします'
            ]
            let max = 1000 * 10;
            let max_score = max * text_data.length * 0.6;
            let current = 0;
            let time = 0;
            let score = 0;
            let first = true;
            let count_down = 3;
            let count_down_handle = undefined;
            let score_wait = false;
            let miss_count = 0;
            let replace_map = [];
            let ikirito_time = false;
            let remain_timer = null;
            let score_time_timer = null;
            let count_up_timer = null;
            let mitotimer = null;
            let fever_time = false;
            let fever_remain = 0;
            let fever_wait = "";
            let fever_width = 0;
            function clear_count_up_timer() {
                if (state == 3) {
                    count_up_timer.clearInterval();
                    status_change();
                    set_result();
                }
            }
            $('body').on('keypress', function (e) {
                var charCode = (typeof e.which == "number") ? e.which : e.keyCode;
                switch (state) {
                    case 0:
                        // title
                        {
                            if (charCode == 13) {
                                status_change(() => {
                                    $('.count_down p').text(count_down);
                                    count_down_handle = new MutekiTimer();
                                    count_down_handle.setInterval(() => {
                                        --count_down;
                                        if (count_down == 0) {
                                            count_down = 3;
                                            status_change();
                                            count_down_handle.clearInterval();
                                            start();
                                            return;
                                        }
                                        $('.count_down p').text(count_down);
                                    }, 1000);
                                    clear();
                                });
                            }
                        }
                        break;
                    case 1:
                        // wait
                        break;
                    case 2:
                        // start
                        {
                            let input_data = $('.wait');
                            let c = input_data.text().substr(0, 1);
                            let val = c.charCodeAt(0);
                            let done = $('.done');
                            if (c == ' ') {
                                done.text(done.text() + c);
                                input_data.text(input_data.text().slice(1));
                                c = input_data.text().substr(0, 1);
                                val = c.charCodeAt(0);
                            }
                            if (String.fromCharCode(charCode).localeCompare(c, "en", { sensitivity: "base" }) == 0) {
                                $.ionSound.play("snap", { volume: volume });
                                input_data.text(input_data.text().slice(1));
                                done.text(done.text() + c);
                                if (input_data.text().length == 0) {
                                    ++current;
                                    if (fever_time == true) {
                                        $.ionSound.play("katana-gesture1", { volume: volume });
                                    } else {
                                        $.ionSound.play("correct2", { volume: volume });
                                    }
                                    let add = (20 - miss_count < 0 ? 0 : 20 - miss_count) / 20;
                                    score_calc();
                                    let current_fever_width = $("#rank span.mori.data").width() + add * 43;
                                    current_fever_width = 215 < current_fever_width ? 215 : current_fever_width;
                                    if (fever_time == false) {
                                        $("#rank span.mori.data").css('width', current_fever_width);
                                    }
                                    if (fever_time == false && current_fever_width >= 215) {
                                        fever_time = true;
                                        fever_remain = 10;
                                        $.ionSound.play("don", { volume: volume });
                                        $('body').addClass('fever');
                                        $('.timer > p').text(fever_remain);
                                        fever_width = $("#rank span.mori.data").width();
                                    }
                                    if (ikirito_time == true) {
                                        score_time_timer.clearInterval();
                                        mitotimer.clearInterval();
                                        status_change(clear_count_up_timer);
                                        break;
                                    }
                                    set();
                                }
                            } else {
                                ++miss_count;
                                $.ionSound.play("incorrect1", { volume: volume * 0.8 });
                            }
                        }
                        break;
                    case 3:
                        // wait end
                        break;
                    case 4:
                        {
                            if (charCode == 13)
                                status_change(undefined, 0);
                        }
                        // result
                        break;
                };
            });
            function status_change(cb, val) {
                ++state;
                if (val != undefined && val == 0) state = val;
                $('body').removeClass().addClass('state_' + state);
                if (cb) {
                    cb();
                }
            }
            function score_calc() {
                let cof = (max - time) < 0 ? 0 : (max - time);
                if (ikirito_time == true) cof = 100;
                cof -= (cof % 10);
                let max_miss = 20;
                let rate = (miss_count / max_miss);
                if (rate >= 1) rate = 1;
                rate = 1 - rate;
                cof *= rate;
                cof *= $('.done').text().length / 15;
                cof = Math.round(cof);
                score += cof;
                time = 0;
                miss_count = 0;
            }
            function set() {
                if (fever_time == true) {
                    let c = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                    fever_wait = c[mt.nextInt(0, c.length)];
                    $('.wait').text(fever_wait).removeClass('break');
                    $('#kana').text(fever_wait);
                    $('.done').text('').removeClass('break');
                    return;
                }
                if (current >= text_data.length) {
                    text_data = shuffle(text_data);
                    current = 0;
                }
                $('.done').text('').removeClass('break');
                let text = text_data[current].data;
                if (ikirito_time == true) {
                    text = ikirito_data.data;
                    $('.timer > p').text('イキリトタイム');
                }
                if (text_data[current].noregex === undefined || ikirito_time) {
                    text = kana2roma(text, replace_map);
                }
                $('.wait').text(text).removeClass('break');
                $('#kana').text(ikirito_time == true ? ikirito_data.origin : text_data[current].origin);
                $.ionSound.play(ikirito_time == true ? ikirito_data.name : text_data[current].name, { volume: volume });
                if (Math.max(str_pixel(text), $('.wait').width()) > window.innerWidth) {
                    $('.done').addClass('break');
                    $('.wait').addClass('break');
                }
            };
            function clear() {
                remain = remain_default;
                current = 0;
                time = 0;
                score = 0;
                miss_count = 0;
                ikirito_time = false;
                $("#rank span.mori.data").css('width', 0);
                $('.timer > p').text('99');
            }
            function set_result() {
                $('.result .score_result p').text(score);
                let selector = Math.floor((score / max_score) * trophies.length);
                if (selector > trophies.length) selector = trophies.length - 1;
                $('.result .trophy p').text(trophies[selector]);
            }
            $('.tweet-share-custom').on('click', function (event) {
                event.preventDefault();
                var href = $(this).attr('href');
                href += '?url=' + escape(location.origin + location.pathname);
                var text = "score : " + $('.result .score_result p').text() + " - " + $('.result .trophy p').text();
                href += '&text=' + text;
                var hashs = $('meta[name=hash]');
                let hash_data = "";
                for (var hash of hashs) {
                    hash_data += $(hash).attr('content') + ",";
                }
                if (hash_data != "") href += '&hashtags=' + hash_data;
                var left = (window.screen.width - 550) * 0.5;
                var top = (window.screen.height - 420) * 0.5;
                window.open(href, '_blank', 'left=' + left + ', top=' + top + ', toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=yes, width=' + 550 + ', height=' + 420);
            });
            function start() {
                text_data = shuffle(text_data);
                replace_map = get_replace_map();
                clear();
                set();
                if (!first) return;
                first = true;

                remain_timer = new MutekiTimer();
                score_time_timer = new MutekiTimer();
                count_up_timer = new MutekiTimer();
                mitotimer = new MutekiTimer();
                mitotimer.setInterval((() => {
                    var date = new Date();
                    var rand = (min, max) => { return Math.random() * (max - min) + min; };
                    var sx = Math.floor(date.getTime() * 0.0001) * rand(1, 13);
                    var sy = Math.floor(date.getTime() * 0.0001) * rand(1, 13);
                    var x = 0;
                    var y = 0;
                    var fx = 1;
                    var fy = 1;
                    var imgw = $('#uzai').width();
                    var imgh = $('#uzai').height();
                    return () => {
                        if (document.hidden) return;
                        var vx = perlin(++sx) * 10;
                        var vy = perlin(++sy) * 10;
                        if ((x + vx * fx + imgw) > window.innerWidth || (x + vx * fx) < 0) {
                            fx *= -1;
                        }
                        if ((y + vy * fy + imgh) > window.innerHeight || (y + vy * fy) < 0) {
                            fy *= -1;
                        }
                        x += vx * fx;
                        y += vy * fy;
                        $('#uzai').css('transform', 'translate(' + x + 'px,' + y + 'px)');
                    };
                })(), 100);
                remain_timer.setInterval(() => {
                    if (fever_time == true) {
                        --fever_remain;
                        $('.timer > p').text(fever_remain);
                        $("#rank span.mori.data").css('width', fever_width * (fever_remain / 10));
                        if (fever_remain == 0) {
                            fever_time = false;
                            $('body').removeClass('fever');
                            $('.timer > p').text(remain);
                            set();
                        }
                    } else {
                        --remain;
                        $('.timer > p').text(remain);
                        if (remain == 0) {
                            ikirito_time = true;
                            remain_timer.clearInterval();
                            set();
                        }
                    }
                }, 1000);
                score_time_timer.setInterval(() => {
                    ++time;
                }, 1);
                count_up_timer.setInterval(() => {
                    let crr = parseInt($('.score p').text());
                    crr += 100;
                    score_wait = true;
                    if (crr >= score) {
                        crr = score;
                        score_wait = false;
                        if (state == 3)
                            clear_count_up_timer();
                    }
                    $('.score p').text(crr);
                }, 10);
            }
        })();
    </script>
</body>

</html>